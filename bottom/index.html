<!DOCTYPE html>

<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Top_banner</title>

    <link rel="stylesheet" href="./css/style.css" />
  </head>

  <body id="body">
    <div id="hellopreloader">
      <div id="hellopreloader_preload"></div>
    </div>

    <div class="bg" id="bg_top">
      <div class="container">
        <img src="./img/right-bg.jpg" alt="" class="bg__img">
      </div>
    </div>

    <div class="bg1" id="bg_top1">
      <div class="container">
        <img src="./img/left-bg.jpg" alt="" class="bg1__img">
      </div>
    </div>

    <div class="cover">
      <div class="ball"></div>
      <div class="line"></div>
    </div>

    <div class="clickAreaTop" id="clickAreaTop"></div>
    <script src="./js/jquery.js"></script>
    <script src="./js/slick.js"></script>
    <script src="./js/script.js"></script>
    <script type="text/javascript">
      var hellopreloader = document.getElementById("hellopreloader_preload");

      function fadeOutnojquery(el) {
        el.style.opacity = 1;

        var interhellopreloader = setInterval(function () {
          el.style.opacity = el.style.opacity - 0.05;

          if (el.style.opacity <= 0.05) {
            clearInterval(interhellopreloader);

            hellopreloader.style.display = "none";
          }
        }, 16);
      }

      window.onload = function () {
        setTimeout(function () {
          fadeOutnojquery(hellopreloader);
        }, 1000);
      };
      
    </script>

    <script>
      var bg_top = document.getElementById("bg_top");

      var bg_top1 = document.getElementById("bg_top1");

      var cover = document.getElementsByClassName("cover")[0];

      var line = document.getElementsByClassName("line")[0];

      var block = document.getElementsByClassName("ball")[0];

      var positionStart = false;

      document.addEventListener("DOMContentLoaded", function () {
        resize();
      });

      window.onresize = function (event) {
        resize();
      };

      function getScrollBarWidth() {
        var $outer = $("<div>")
            .css({
              visibility: "hidden",
              width: 100,
              overflow: "scroll",
            })
            .appendTo("body"),
          widthWithScroll = $("<div>")
            .css({
              width: "100%",
            })
            .appendTo($outer)
            .outerWidth();

        $outer.remove();

        return 100 - widthWithScroll;
      }

      function resize() {
        getScrollBarWidth();
      }

      var a = getScrollBarWidth();

      block.onmousedown = saveXY;

      document.onmouseup = clearXY;

      function saveXY(obj_event) {
        if (obj_event) {
          x = obj_event.pageX;

          y = obj_event.pageY;
        } else {
          x = window.event.clientX;
        }

        /* Узнаём текущие координаты блока */

        x_block = block.offsetLeft;

        /* Узнаём смещение */

        delta_x = x_block - x;

        /* При движении курсора устанавливаем вызов функции moveWindow */

        document.onmousemove = moveBlock;
      }

      function clearXY() {
        console.log(widthBackground);

        document.onmousemove = null; // При отпускании мыши убираем обработку события движения мыши

        // if (position > widthBackground) {
        //     position = widthBackground - 50;
        //     parent.postMessage(JSON.stringify({
        //         position: position
        //     }), '*');
        // }
        // if (position < -20) {
        //     position = 10;
        //     parent.postMessage(JSON.stringify({
        //         position: position
        //     }), '*');
        // }
      }

      var positionEnd;

      setInterval(function () {
        // if (position > (widthBackground - 10)) {
        //     // clearXY();
        //     position = widthBackground - 40;
        //     block.style.left = position + 'px';
        //     line.style.left = position + 'px';
        // }
        // if (position + 10 > widthBackground) {
        //     block.style.left = widthBackground - 50 + "px";
        //     line.style.left = widthBackground - 50 + "px";
        // }
      }, 50);

      function moveBlock(obj_event) {
        positionStart = true;

        /* Получаем новые координаты курсора мыши */

        if (obj_event) {
          x = obj_event.pageX;
        } else {
          x = window.event.clientX;
        }

        /* Вычисляем новые координаты блока */

        new_x = delta_x + x;

        block.style.left = new_x + "px";

        line.style.left = new_x + "px";

        position = new_x;

        if (position > widthBackground - 50) {
          position = widthBackground - 50;
          positionStart = false;
          parent.postMessage(
            JSON.stringify({
              position: position,
            }),
            "*"
          );
        }

        parent.postMessage(
          JSON.stringify({
            position: position,
          }),
          "*"
        );
      }

      var heightBackground;

      var widthBackground;

      var curscroll;

      var position;

      var res = false;

      window.addEventListener("message", function (event) {
        var parseData = JSON.parse(event.data);

        if (parseData.h != undefined) {
          heightBackground = parseData.h;
        }

        if (parseData.w != undefined) {
          widthBackground = parseData.w;
        }

        if (parseData.scrollPos != undefined) {
          curscroll = parseData.scrollPos;
        }

        if (parseData.position != undefined) {
          position = parseData.position;
        }

        if (parseData.res != undefined) {
          res = parseData.res;
        }

        if (res) {
          positionStart = true;

          bg_top1.setAttribute(
            "style",
            "left: calc(50% - " +
              a / 2 +
              "px);  clip-path: polygon(0 0, " +
              (position + 30) +
              "px 0, " +
              (position + 30) +
              "px 100%, 0 100%); width: " +
              widthBackground +
              "px; height: " +
              heightBackground +
              "px"
          );

          $(".ball").removeClass("ballActive");

          $(".line").removeClass("lineActive");

          $(".bg1").removeClass("bg1Active");

          block.style.left = position + "px";

          line.style.left = position + "px";
        }
      });

      var res = false;

      setInterval(function () {
        var q = parseInt(widthBackground);

        if (!positionStart) {
          if (widthBackground < 1921 && widthBackground > 1601) {
            block.style.left = 1600 + "px";
            line.style.left = 1600 + "px";
            bg_top1.setAttribute(
              "style",
              "clip-path: polygon(0 0, " +
                1630 +
                "px 0, " +
                1630 +
                "px 100%, 0 100%); width: " +
                widthBackground +
                "px; height: " +
                heightBackground +
                "px"
            );
          }

          if (widthBackground < 1601 && widthBackground > 1500) {
            block.style.left = 1370 + "px";
            line.style.left = 1370 + "px";
            bg_top1.setAttribute(
              "style",
              "clip-path: polygon(0 0, " +
                1400 +
                "px 0, " +
                1400 +
                "px 100%, 0 100%); width: " +
                widthBackground +
                "px; height: " +
                heightBackground +
                "px"
            );
          }

          if (widthBackground < 1500 && widthBackground > 1400) {
            block.style.left = 1250 + "px";
            line.style.left = 1250 + "px";
            bg_top1.setAttribute(
              "style",
              "clip-path: polygon(0 0, " +
                1280 +
                "px 0, " +
                1280 +
                "px 100%, 0 100%); width: " +
                widthBackground +
                "px; height: " +
                heightBackground +
                "px"
            );
          }

          if (widthBackground < 1400 && widthBackground > 1300) {
            block.style.left = 1200 + "px";
            line.style.left = 1200 + "px";
            bg_top1.setAttribute(
              "style",
              "clip-path: polygon(0 0, " +
                1230 +
                "px 0, " +
                1230 +
                "px 100%, 0 100%); width: " +
                widthBackground +
                "px; height: " +
                heightBackground +
                "px"
            );
          }

          if (widthBackground < 1300) {
            block.style.left = 1150 + "px";
            line.style.left = 1150 + "px";
            bg_top1.setAttribute(
              "style",
              "clip-path: polygon(0 0, " +
                1178 +
                "px 0, " +
                1178 +
                "px 100%, 0 100%); width: " +
                widthBackground +
                "px; height: " +
                heightBackground +
                "px"
            );
          }
        } else {
          $(".ball").removeClass("ballActive");

          $(".line").removeClass("lineActive");

          $(".bg1").removeClass("bg1Active");

          parent.postMessage(
            JSON.stringify({
              res: true,
            }),
            "*"
          );
        }

        bg_top.setAttribute(
          "style",
          "left: calc(50% - " +
            a / 2 +
            "px); width: " +
            widthBackground +
            "px; height: " +
            heightBackground +
            "px"
        );

        cover.setAttribute(
          "style",
          "left: calc(50% - " +
            a / 2 +
            "px); width: " +
            widthBackground +
            "px; height: " +
            heightBackground +
            "px"
        );

        bg_top1.setAttribute(
          "style",
          "left: calc(50% - " +
            a / 2 +
            "px); clip-path: polygon(0 0, " +
            (position + 30) +
            "px 0, " +
            (position + 30) +
            "px 100%, 0 100%); width: " +
            widthBackground +
            "px; height: " +
            heightBackground +
            "px"
        );
      }, 1);

      setInterval(function () {
        block.style.left = position + "px";
        line.style.left = position + "px";
      }, 1);
    </script>

    <script>
      var x_click = document.getElementsByClassName("clickAreaTop")[0];

      x_click.addEventListener("click", clickout_1);

      hellopreloader.addEventListener("click", clickout_1);

      var clickTag = readGETParameter("dspx_clicktag_p");

      var dspx_debug = readGETParameter("dspx_debug"),
        clickoutLinkRedirect = readGETParameter("dspx_clicktag"),
        clickoutLink2 = readGETParameter("dspxct"),
        clickoutEncodeLevel = readGETParameter("dspx_encodelevel");

      function readGETParameter(c) {
        var n = window.location.search.substring(1),
          i = n.split("&");

        for (var e = 0; e < i.length; e++) {
          var o = i[e].split("=");

          if (o[0] == c) {
            return decodeURIComponent(o[1]);
          }
        }

        return c == "dspx_encodelevel" ? 2 : 0;
      }

      function clickout_1() {
        fireASCClicks();

        var e = clickTag;

        if (clickoutLinkRedirect != 0) {
          e = clickoutLinkRedirect + btoa(e);
        }

        if (clickoutLink2 != 0) {
          e = clickoutLink2 + encodeURIComponent(e);
        }

        if (dspx_debug) console.log(e);

        window.open(e);
      }

      function fireASCClicks() {
        var _c = "dspx_clicktagASC",
          _nn = 5;

        var cASC = function (c, nn) {
          var n = window.location.search.substring(1),
            i = n.split("&");

          var aa = [];

          for (var e = 0; e < i.length; e++) {
            var o = i[e].split("=");

            for (var ni = 0; ni < nn; ni++) {
              if (ni == 0) cc = c;
              else cc = c + ni;

              if (o[0] == cc) {
                aa.push(decodeURIComponent(o[1]));
              }
            }
          }

          return aa;
        };

        var ctASC = cASC(_c, _nn);

        for (i = 0; i < ctASC.length; i++) {
          if (dspx_debug == 1) console.log("fire Click ASC:" + ctASC[i]);

          new Image().src = ctASC[i];
        }
      }
    </script>
  </body>
</html>
